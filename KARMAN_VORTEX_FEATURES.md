# 卡门涡街实验 - 数据处理与导出功能

## 🎯 功能概述

卡门涡街实验现已集成完整的数据处理与导出功能，支持实时数据监控、历史数据记录、统计分析和多格式导出。

## 🚀 新增功能

### 1. 实时数据监控
- **实时显示**：时间、最大涡量、平均速度、斯特劳哈尔数、阻力系数
- **自动计算**：基于物理参数自动计算关键流体力学指标
- **动态更新**：数据每秒更新多次，实时反映仿真状态

### 2. 数据记录功能
- **一键录制**：点击"开始录制"按钮开始数据收集
- **实时计时**：显示录制进行时间
- **参数锁定**：录制期间锁定实验参数，确保数据一致性
- **历史存储**：自动保存所有时间序列数据

### 3. 数据分析图表
- **涡量变化图**：显示最大涡量随时间的变化趋势
- **升力系数图**：展示升力系数的周期性变化
- **平均速度图**：监控流场平均速度的演化
- **交互式图表**：支持缩放、平移、工具提示等交互功能

### 4. 统计分析
- **平均斯特劳哈尔数**：计算整个实验周期的平均St数值
- **最大涡量**：记录实验期间的最大涡量值
- **平均阻力系数**：统计平均阻力系数
- **升力系数RMS**：计算升力系数的均方根值
- **采样统计**：显示采样点数和实验时长

### 5. 多格式数据导出
- **CSV格式**：适合Excel等表格软件分析
- **JSON格式**：便于程序化处理和存档
- **VTK格式**：兼容ParaView等专业CFD后处理软件
- **PNG图像**：导出可视化结果图像
- **一键下载**：自动生成文件名并触发下载

## 📊 数据结构

### 实时数据 (SimulationData)
```typescript
interface SimulationData {
  time: number;              // 仿真时间 (s)
  maxVorticity: number;      // 最大涡量 (1/s)
  avgVelocity: number;       // 平均速度 (m/s)
  pressure: number;          // 平均压力 (Pa)
  strouhalNumber: number;    // 斯特劳哈尔数
  dragCoefficient: number;   // 阻力系数
  liftCoefficient: number;   // 升力系数
}
```

### 导出数据 (ExportData)
```typescript
interface ExportData {
  experimentType: string;    // 实验类型
  timestamp: string;         // 时间戳
  parameters: {              // 实验参数
    reynoldsNumber: number;
    obstacleSize: number;
    flowSpeed: number;
    duration: number;
  };
  results: {                 // 实验结果
    timeHistory: SimulationData[];
    statistics: {
      avgStrouhalNumber: number;
      maxVorticity: number;
      avgDragCoefficient: number;
      rmsLiftCoefficient: number;
    };
  };
  metadata: {                // 元数据
    samplingRate: number;
    totalSamples: number;
    experimentDuration: number;
  };
}
```

## 🎮 使用指南

### 第一步：设置实验参数
1. 调整**雷诺数** (40-300)：控制流动状态
2. 设置**圆柱直径** (0.5-2.0)：改变障碍物尺寸
3. 配置**流速** (0.5-3.0 m/s)：调节来流速度
4. 选择**可视化选项**：涡量场、压力场、速度场、流线

### 第二步：开始数据录制
1. 点击**"开始录制"**按钮
2. 观察实时数据更新
3. 等待足够的数据积累（建议20-60秒）
4. 点击**"停止录制"**完成数据收集

### 第三步：查看数据分析
1. 点击**"显示数据面板"**
2. 查看实时更新的数据图表
3. 分析涡量、升力系数、速度的变化趋势
4. 查看统计信息摘要

### 第四步：导出实验数据
1. 在数据面板中找到**"导出管理器"**
2. 选择导出格式（CSV/JSON/VTK/PNG）
3. 点击**"导出"**按钮
4. 文件将自动下载到本地

## 📈 物理意义解读

### 斯特劳哈尔数 (St)
- **公式**：St = f·D/U
- **物理意义**：涡旋脱落的无量纲频率
- **典型值**：对于圆柱，St ≈ 0.2
- **应用**：预测涡激振动频率

### 阻力系数 (Cd)
- **定义**：阻力与动压力的比值
- **影响因素**：雷诺数、表面粗糙度
- **工程意义**：结构受力计算的关键参数

### 升力系数 (Cl)
- **特征**：周期性变化，与涡旋脱落同步
- **振幅**：反映涡旋强度
- **频率**：与斯特劳哈尔数相关

## 🔬 实验建议

### 推荐参数组合
1. **经典卡门涡街**：Re=100, D=1.0, U=1.0
2. **高雷诺数**：Re=200, D=1.5, U=2.0
3. **低雷诺数**：Re=60, D=0.8, U=0.8

### 数据收集建议
- **录制时长**：至少20秒，推荐30-60秒
- **稳定时间**：开始录制前等待3-5秒让流场稳定
- **参数变化**：每次改变参数后重新录制

### 分析要点
1. 观察涡量的周期性变化
2. 分析升力系数的振荡特征
3. 计算实际斯特劳哈尔数与理论值的偏差
4. 研究雷诺数对流动特征的影响

## 🛠️ 技术实现

### 数据采集
- **采样频率**：约10-20 Hz
- **数据来源**：3D流体仿真引擎实时计算
- **处理方式**：实时计算统计量和衍生参数

### 可视化技术
- **图表库**：Recharts (React)
- **实时更新**：基于状态管理的响应式更新
- **交互功能**：缩放、工具提示、数据筛选

### 导出功能
- **多格式支持**：CSV、JSON、VTK、PNG
- **自动命名**：基于实验类型和时间戳
- **浏览器下载**：利用Blob API和下载链接

## 📝 注意事项

1. **浏览器性能**：长时间录制可能影响性能，建议分段进行
2. **数据精度**：仿真数据为近似值，用于教学和定性分析
3. **文件大小**：长时间录制会产生较大的导出文件
4. **兼容性**：建议使用现代浏览器（Chrome、Firefox、Safari）

## 🎓 教学应用

### 课堂演示
- 实时展示卡门涡街形成过程
- 对比不同雷诺数下的流动特征
- 验证斯特劳哈尔数的理论值

### 学生实验
- 设计参数研究实验
- 分析数据并撰写实验报告
- 探索流体力学的基本规律

### 研究用途
- 初步的参数研究
- 教学案例的数据支持
- 概念验证和原理演示

---

**访问地址**：http://localhost:3000/lab/karman-vortex

**开发团队**：流体力学仿真实验室

**更新日期**：2024年 